empty:
  src: ""
  res: ""

hello:
  src: "<r:hello/>"
  res: "hello world!"
  
double_hello:
  src: "<r:hello/> <r:hello/>"
  res: "hello world! hello world!"

ignore_html:
  src: "<div class='test'><p>some <i>funny</i> text</p></div>"
  res: "<div class='test'><p>some <i>funny</i> text</p></div>"

hello_skip_content:
  src: "<r:hello>I want to live forever</r:hello>"
  res: "hello world!"

tag_not_closed:
  src: "this is <r:test super='life' is = \"fine\""
  res: "this is <r:test super='life' is = \"fine\""

hello_not_closed:
  src: "I say <r:hello>blah blah"
  res: "I say hello world!"

test:
  src: "this <r:test>is a test</r:test> <r:hello/>"
  res: "this [test]is a test[/test] hello world!"
  
very_messy:
  src: "this <r: blah> </r:truc> whak"
  res: "this <r: blah> <span class='parser_error'>&lt;/r:truc&gt;</span> whak"

bad_closing_tag:
  src: "this <r:test>looks </r:truc> ok"
  res: "this [test]looks <span class='parser_error'>&lt;/r:truc&gt;</span>[/test] ok"

do_tag:
  src: "I say <p do='hello'>blah blah</p>"
  res: "I say <p>hello world!</p>"

do_tag_count:
  src: "I say <p do='hello'>blah <p>super</p> blah</p> is good"
  res: "I say <p>hello world!</p> is good"

do_tag_closed:
  src: "I say <p do='hello'/> is good"
  res: "I say <p>hello world!</p> is good"

do_tag_block:
  src:  "I say <div do='test'>this <div>test</div> is ok</div> right?"
  res: "I say [test]<div>this <div>test</div> is ok</div>[/test] right?"

do_tag_at_end:
  src:  "I say <div do='test'>this <div>test</div> is ok</div>"
  res: "I say [test]<div>this <div>test</div> is ok</div>[/test]"

do_tag_with_ztags:
  src: "I say <div do='test'>this <r:hello/></div>"
  res: "I say [test]<div>this [hello/]</div>[/test]"

do_keep_params:
  src: "I love <div class='truc' id='machin' do='test' depth='3'>my wife</div>"
  res: "I love [test {= :depth=>'3'}]<div class='truc' id='machin'>my wife</div>[/test]"

do_class_params:
  src: "<div class='one' do='test' do='test' tag='p' class='two'>blah</div>"
  res: "[test]<div class='one'>[test]<p class='two'>blah</p>[/test]</div>[/test]"

do_and_ztags:
  src: "Hey <r:test>this is <p do='hello'>ok</p></r:test>"
  res: "Hey [test]this is [hello]<p>ok</p>[/hello][/test]"

do_same_tag:
  src: "Hey <p do='test'> is <p do='hello'>hello <p>cool</p></p></p>"
  res: "Hey [test]<p> is [hello]<p>hello <p>cool</p></p>[/hello]</p>[/test]"  
expand_with:
  src: "this <r:test>looks </r:test> ok"
  res: "this [test]looks [/test] ok"
  
params:
  src: "some <r:test good='choice' nice='work'>things</r:test> are fine"
  res: "some [test {= :good=>'choice', :nice=>'work'}]things[/test] are fine"

default_menu:
  src: "the <r:test>menu</r:test> is nice"
  res: "the [test]menu[/test] is nice"
  
include_menu:
  src: "include_menu: <r:include template='/default/menu'/>"
  res: "include_menu: the [test]menu[/test] is nice"

include_context:
  src: "include_context: <r:include template='menu'/>"
  res: "include_context: include_menu: the [test]menu[/test] is nice"

infinite_loop:
  src: "<r:include template='/infinite/loop'/>"
  res: "<span class='parser_error'>[include error: /infinite/loop --&gt; /infinite/loop ]</span>"
  
infinite_foo:
  src: "<r:include template='bar'/>"
  res: "<span class='parser_error'>[include error: /infinite/foo --&gt; /infinite/bar --&gt; /infinite/foo ]</span>"
  
infinite_bar:
  src: "<r:include template='foo'/>"
  res: "<span class='parser_error'>[include error: /infinite/bar --&gt; /infinite/foo --&gt; /infinite/bar ]</span>"
  
default_context:
  src: "from other: <r:include template='menu'/> and <r:include template='/include/menu'/>"
  res: "from other: the [test]menu[/test] is nice and include_menu: the [test]menu[/test] is nice"

set_context:
  src: "res:<r:test/> <r:set_context truc='machin'>src:<r:test/></r:set_context> res:<r:test/>"
  res: "res:[test/] src:[test {> :truc=>'machin'}/] res:[test/]"
  
nested_set_context:
  src: "<r:set_context var1='out' var2='foo'>1:<r:test/><r:set_context var1='in'>2:<r:test/></r:set_context>3:<r:test/></r:set_context>"
  res: "1:[test {> :var1=>'out', :var2=>'foo'}/]2:[test {> :var1=>'in', :var2=>'foo'}/]3:[test {> :var1=>'out', :var2=>'foo'}/]"

complex_example:
  src: |
    Some people say <r:hello/>
    Some say <r:include template='/default/menu'/>
      <ul class='list' do='set_context' life='ok'>
        <li>truc</li>
        <li>machin</li>
        <li do='test'>sunny day</li>
      </ul>
    <r:set_context var='complex'><r:include template='/default/menu'/></r:set_context>
  res: |
    Some people say hello world!
    Some say the [test]menu[/test] is nice
      <ul class='list'>
        <li>truc</li>
        <li>machin</li>
    [test {> :life=>'ok'}]    <li>sunny day</li>
    [/test]  </ul>
    the [test {> :var=>'complex'}]menu[/test] is nice

unknown:
  src:  "this looks bad: <r:system truc='lala'/>"
  res: "this looks bad: <span class='parser_unknown'>&lt;z:system truc='lala'/&gt;</span>"
  
check_params:
  src: "bad <r:missing/> params"
  res: "bad [missing parameter(s) missing:good, night] params"

check_params_partial:
  src: "bad <r:missing good='ok'/> params"
  res: "bad [missing parameter(s) missing:night] params"

check_params_ok:
  src: "bad <r:missing good='ok' night='hey'/> params"
  res: "bad nothing missing params"

doctype:
  src: |
    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
    <title do='test'>node title</title>
    end
  res: |
    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
    [test]<title>node title</title>
    [/test]end
no_tag:
  src: "<r:set_context no_test='true'>this is a <r:test>test</r:test>dog</r:set_context>"
  res: "this is a dog"
  
html_comments:
  src: "<r:test><r:hello/><!-- this is nothing > <r:hello/>  --></r:test>"
  res: "[test][hello/]<!-- this is nothing > <r:hello/>  -->[/test]"

html_do_comment:
  src: "<r:test><r:hello/><!--|this is not a comment <r:hello/>  --></r:test>"
  res: "[test][hello/]this is not a comment [hello/]  [/test]"

do_simple:
  src: "<r:test do='hello'/>"
  res: "[test][hello/][/test]"
  
do_zafu:
  src: "<p do='test' param='yo' do='hello' param='hey'>some thing</p>"
  res: "[test {= :param=>'yo'}]<p>[hello {= :param=>'hey'}]some thing[/hello]</p>[/test]"
  
do_multiple:
  src: "<r:test param='1' do='test' param='2' do='hello' param='3'/>"
  res: "[test {= :param=>'1'}][test {= :param=>'2'}][hello {= :param=>'3'}/][/test][/test]"

do_with_inner:
  src: "<r:test do='hello'>a thing <r:hello/> here</r:test>"
  res: "[test][hello]a thing [hello/] here[/hello][/test]"

ztag_tag:
  src: "<r:hello tag='p'/>"
  res: "<p>hello world!</p>"

name:
  src: "super: <r:void name='super'>hey <r:void name='man' do='text' text='ho'/></r:void>"
  res: "super: hey ho"

include_super:
  src: "include_super: <r:include template='/name'><p do='with' part='super' do='hello'/>"
  res: "include_super: super: <p>hello world!</p>"

include_super_man:
  src: "include_super: <r:include template='/name'><p do='with' part='super/man' do='hello'/>"
  res: "include_super: super: hey <p>hello world!</p>"

name_title:
  src: "title: <h1 do='void' name='title' do='text' text='dummy'>blah <b do='void' name='comment'>nothing</b></h1>"
  res: "title: <h1>dummy</h1>"

ztag_same_name_as_tag:
  src: "<r:test>this is a <test>test</test></r:test>"
  res: "[test]this is a <test>test</test>[/test]"

include_with:
  src: "include_with: <r:include template='/name/title'><h1 do='with' part='title' do='hello'/></r:include>"
  res: "include_with: title: <h1>hello world!</h1>"

include_with_keep_name:
  src: "keep name: <r:include template='/name/title'><h1 do='with' part='title'><r:hello/> <i do='void' name='comment'>none</i></h1></r:include>"
  res: "keep name: title: <h1>hello world! <i>none</i></h1>"
  
include_include:
  src: "from ii: <r:include template='/include/with/keep/name'><r:with part='title/comment'>rabbit</r:with></r:include>"
  res: "from ii: keep name: title: <h1>hello world! <i>rabbit</i></h1>"

include_for_reverse:
  src: "from ifr: <r:include template='/name'><r:with part='super/comment'>IFR</r:with></r:include>"
  res: "from ifr: super: hey ho"

include_replace_same:
  src: "from IRS: <r:include template='/include/super/man'><span do='with' part='super/man'>goldorak</span></r:include>"
  res: "from IRS: include_super: super: hey <span>goldorak</span>"

include_reverse:
  src: "from ir: <r:include template='/include/for/reverse'><h1 do='with' part='super'><i do='void' name='comment'>none</i> <r:hello/></h1></r:include>"
  res: "from ir: from ifr: super: <h1><i>IFR</i> hello world!</h1>"

include_empty:
  src: "include_empty: <r:include template='/name/title'><r:with part='title'/></r:include>"
  res: "include_empty: title: "

preserve_newlines:
  src: |
    <r:repeat><p do='test'>blah</p>
    </r:repeat>ok
    
  res: |
    [test]<p>blah</p>
    [/test][test]<p>blah</p>
    [/test]ok

names:
  src: "<p do='void' name='root'><p do='inspect' name='first'/><p do='inspect' name='second'/></p>"
  res: "<p>[inspect {= :name=>'first'} {> :name=>'root/first'}]<p/>[/inspect][inspect {= :name=>'second'} {> :name=>'root/second'}]<p/>[/inspect]</p>"

default_tag:
  src: "<r:void class='test'>blah</r:void>"
  res: "<div class='test'>blah</div>"

set_tag_param:
  src: "<r:void class='test' tag='p'>blah</r:void>"
  res: "<p class='test'>blah</p>"