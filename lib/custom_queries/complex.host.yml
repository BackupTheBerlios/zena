NodeQuery:
  # form_dates
  form_date:
    select:
      - no1.id
      - no1.name
      - form.event_at + INTERVAL no1.custom_a MONTH AS log_at
      - form.event_at AS event_at
    tables:
      - nodes
      - links
      - nodes AS no1
      - links AS li1
    join_tables:
      no1:
        - LEFT JOIN nodes AS form INNER JOIN links AS flink ON flink.relation_id = RELATION_ID(assigned_formation) AND flink.target_id = NODE_ID AND flink.source_id = form.id AND flink.status = 100 ON form.project_id = no1.id
    where:
      - no1.id = li1.source_id AND li1.relation_id = RELATION_ID(assigned_course) AND li1.target_id = nodes.id
      - nodes.kpath LIKE 'NP%'
      - nodes.project_id = links.target_id
      - links.relation_id = RELATION_ID(assigned_job) AND links.source_id = NODE_ID
    group: no1.id
    order: event_at ASC, no1.name ASC