== Zena
CMS based on Ruby on Rails, (c) Gaspard Bucher, teti.ch 2007, licenced under MIT

== Creating the database
You need to set collation and charset to utf8 when creating the database. Example :
# create database zena DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;

== Development/testing
1. Create the database using a mysql client
   create database zena_dev DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;

2. Migrate the database and add initialize db (from within zena directory)
   rake zena:migrate

3. Create a first site or load fixtures
   rake zena:mksite HOST=localhost PASSWORD=secret LANG=en

4. Start server
   script/server

5. Connect to site 'http://localhost:3000'

6. Login with 'admin' and 'secret'

== Production
You should use capistrano to ease deployment. See 'config/delploy.rb'.

Manual deployment is done with the following commands:
1. Create the database with (using a mysql client)
   create database zena DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;
   
2. create log directory
   mkdir log
   
3. update config/database.yml
   (change user, password if needed)
   
4. migrate the database
   rake zena:migrate RAILS_ENV=production

4. Create a site
   rake zena:mksite HOST=example.com PASSWORD=secret LANG=en RAILS_ENV=production
   
5. Login user is 'admin', password is the one set on the line above.

== Create a new site
# rake zena:mksite HOST=example.com PASSWORD=secret RAILS_ENV=production

== Start
# script/server

== Login
You can now login with 'admin' and the password you used to make the site.

== Dependencies

=== 1. Original in debian etch
build-essential apache2 mysql-server libmagick9-dev gs-gpl libssl-dev gettext libgettext-ruby libreadline5 libreadline5-dev zlib1g-dev libncurses5 libncurses5-dev temcap-compat

=== 2. To be installed by hand
ruby1.8.6
    # wget ftp://ftp.ruby-lang.org/pub/ruby/1.8/ruby-1.8.6.tar.gz
    # tar xzf ruby-1.8.6.tar.gz
    # cd ruby-1.8.6
    # ./configure --with-openssl
    # make && make install
rubygems
    # wget http://rubyforge.org/frs/download.php/29548/rubygems-1.0.1.tgz
    # tar xzf rubygems-1.0.1.tgz
    # cd rubygems-1.0.1
    # ruby setup.rb (if ruby is not found, log out and log back in)
ImageMagick
    # wget ftp://ftp.imagemagick.org/pub/ImageMagick/ImageMagick.tar.gz
    # tar xzf ImageMagick.tar.gz
    # cd ImageMagick
    # ./configure
    # make && make install

=== 3. Gems
rake, mongrel, mongrel_cluster, rmagick, redcloth, syntax, gettext

=== Advised tools
monit (debian package to monitor your mongrel processes)


== Very experimental webDAV
Should not be used for production.

add this to nodes_controller macros:
  act_as_railsdav
  include Zena::WebDav

add this to 'config/environment.rb'
  require File.join(File.dirname(__FILE__), '../lib/webdav_adapter')

install railsdav
  # script/plugin install http://svn.liverail.net/svn/plugins/railsdav

install dependencies
  # sudo gem install mime-types, unicode