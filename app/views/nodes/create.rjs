if @node.new_record?
  page.replace_html 'add_page_form', :partial=>'form'
  page << "$('page_name').focus();"
else
  pos = params[:position] || :before
  ref = params[:reference] || "#{params[:template_url]}_add"
  page.insert_html pos.to_sym, ref, :file => fullpath_from_template_url + ".erb"
  @node    = Node.new
  page.replace "#{params[:template_url]}_form", :file => fullpath_from_template_url + "_form.erb"
  page.toggle "#{params[:template_url]}_form", "#{params[:template_url]}_add"
end